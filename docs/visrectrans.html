---

title: VisRecTrans


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "00_visrectrans.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_visrectrans.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VisRecTrans" class="doc_header"><code>class</code> <code>VisRecTrans</code><a href="https://github.com/Ys-Prakash/transcv/tree/master/transcv/visrectrans.py#L116" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VisRecTrans</code>(<strong><code>model_name</code></strong>, <strong><code>num_classes</code></strong>, <strong><code>pretrained</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Class for setting up a vision transformer for visual recognition.</p>
<p>Attributes :
    model_name : The name of the model
    num_classes : The number of classes to output
    pretrained : Outputs a pretrained model if set to True (by-default), or, a model with random weights if set to False.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="VisRecTrans.create_model" class="doc_header"><code>VisRecTrans.create_model</code><a href="https://github.com/Ys-Prakash/transcv/tree/master/transcv/visrectrans.py#L156" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>VisRecTrans.create_model</code>()</p>
</blockquote>
<p>Method for creating the model.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="VisRecTrans.initialize" class="doc_header"><code>VisRecTrans.initialize</code><a href="https://github.com/Ys-Prakash/transcv/tree/master/transcv/visrectrans.py#L161" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>VisRecTrans.initialize</code>(<strong><code>model</code></strong>)</p>
</blockquote>
<p>Mthod for initializing the model. This method uses truncated normal distribution for
initializing the position embedding as well as the class token, and, kaiming normal
distribution for the initializing the head of the model.</p>
<p>Attributes :
    model : The model to be initialized</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see if the API is working well.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vis_rec_ob</span> <span class="o">=</span> <span class="n">VisRecTrans</span><span class="p">(</span><span class="s1">&#39;vit_small_patch16_224&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">model_test</span> <span class="o">=</span> <span class="n">vis_rec_ob</span><span class="o">.</span><span class="n">create_model</span><span class="p">()</span>
<span class="n">vis_rec_ob</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">model_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_test</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we see, the model is a sequential list of modules, and can be used with the <code>Learner</code> API of fastai, as we use any other model.</p>

</div>
</div>
</div>
</div>
 

